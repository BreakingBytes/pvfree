{% extends "base.html" %}
{% load staticfiles %}

{% block headers %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
<!-- <link rel="stylesheet" href="{% static 'highlight/styles/default.css' %}"> -->
{% endblock headers %}

{% block content %}

<!-- Main jumbotron for a primary marketing message or call to action -->
<div style="text-align:center">
  <div class="jumbotron">
    <div class="container">
      <h1>PV Free</h1>
      <p class="lead">A public API for PV modeling parameters.</p>
    </div><!-- /.container -->
  </div>
</div>

<div class="container">
  <h1>Usage</h1>
  <p>
    Browsing to <a target="_blank" href="/api/v1/pvinverter/?format=json"><code>pvfree.azurewebsites.net/api/v1/pvinverter/?format=json</code></a>
    will display a <a target="_blank" href="http://json.org/">JSON</a> string with the first 20 records. The endpoint and query string to obtain
    the next set <a target="_blank" href="/api/v1/pvinverter/?format=json&limit=20&offset=20"><code>api/v1/pvinverter/?limit=20&offset=20</code></a>
    is contained in the <code>next</code> key of the string as are the endpoints for each inverter. <i>Note:</i> the query string <code>?format=json</code>
    is only necessary when using the API directly in a browser to display the response. Other formats like <a href="https://www.xml.com/">XML</a> and
    <a href="http://yaml.org/">YAML</a> can also be used. When submitting requests, the default format will be JSON but can be changed in the header,
    <i>i.e.:</i> <code>Accept: application/xml</code>. Use the links in the navigation bar at the top of the page to view human readable, searchable,
    sortable tables of the API resources in the database.
  </p>
  <h2>Build status</h2>
  <p><a href="https://travis-ci.org/BreakingBytes/pvfree/" target="_blank">
    <img src="https://travis-ci.org/BreakingBytes/pvfree.svg?branch=master"></a>
    &nbsp;PV Free is tested on every commit to the master branch on
    <a href="https://travis-ci.org" target="_blank">Travis-CI</a>.
  </p>
  <h2>Announcements</h2>
  <p>
    pvfree is moving to Microsoft Azure Cloud b/c Heroku free dyno service will
    end Nov 28th. Please use <a href="https://pvfree.azurewebsites.net/">https://pvfree.azurewebsites.net/</a>
    from now on to get module and inverter parameters for pvlib and to learn
    about solar energy modeling.
  </p>
  <h2>API Endpoints</h2>
  <p>The API offers CRUD list and detail operations for the following resources:</p>
  <div class="row"><div class="col-md-2"></div><div class="col-md-8">
  <table class="table table-striped table-bordered table-condensed">
    <thead><tr><th>API</th><th>Endpoint</th></tr></thead>
    <tbody>
        <tr><td><b>CEC/Sandia Inverters</b></td><td><code>/api/v1/pvinverter/</code></td></tr>
        <tr><td><b>Sandia Modules</b></td><td><code>/api/v1/pvmodule/</code></td></tr>
      <tr><td><b>CEC Modules</b></td><td><code>/api/v1/cecmodule/</code></td></tr>
    </thead>
  </table>
  <div class="col-md-2"></div></div></div>
  <p>The parameter schemas are determined by the models in <a href="https://pvlib-python.readthedocs.io/en/latest/" target="_blank">PVLIB</a>.</p>
  <h2>Tastypie</h2>
  <p>The API is generated by the <a target="_blank" href="https://django-tastypie.readthedocs.org/en/latest/">Tastypie</a>
    Django extension. Add the following endpoints to the base URL, 
<a target="_blank" href="/"><code>https://pvfree.azurewebsites.net/</code></a>:</p>
  <ul>
  <li>Get first 20 pvinverters.
  <pre>api/v1/pvinverter/</pre>
  </li>
  <li>Get first pvinverter.
  <pre>api/v1/pvinverter/1/</pre>
  </li>
  <li>Get pvinverter set containing #'s 2, 3, 5, and 10.
  <pre>api/v1/pvinverter/set/2;3;5;10/</pre>
  </li>
  <li>Get 100 pvinverters starting from pvinverter # 500.
  <pre>api/v1/pvinverter/?limit=100&amp;offset=500</pre>
  </li>
  <li>Get pvinverter database schema.
  <pre>api/v1/pvinverter/schema/</pre>
  </li>
  </ul>
  <h2>Python Requests</h2>
  <p><a targt="_blank" href="https://python.org">Python</a> has several libraries for interacting with URLs. The
    <a target="_blank" href="https://requests.readthedocs.io/en/master/">Requests</a> package is available from
    <a target="_blank" href="https://pypi.python.org/pypi/requests">PyPI</a>.</p>
<pre><code class="language-python">&gt;&gt;&gt; import requests
&gt;&gt;&gt; response = requests.get('https://pvfree.azurewebsites.net/api/v1/pvinverter/set/1;3;5/')
&gt;&gt;&gt; response
  &lt;Response [200]&gt;
&gt;&gt;&gt; response.status_code
  200
&gt;&gt;&gt; response.content
  {"objects": [{"C0": -2.48104842861e-05, "C1": -9.0149429405099999e-05, "C2": 0.00066889632690700005, "C3": -0.018880466688599998, "Idcmax": 10.0, "Mppt_high": 50.0, "Mppt_low": 20.0, "Paco": 250.0, "Pdco": 259.52205054799998, "Pnt": 0.02, "Pso": 1.7716142241299999, "Vac": 208.0, "Vdcmax": 65.0, "Vdco": 40.242603174599999, "id": 1, "Name": "MICRO-0.25-I-OUTD-US-208", "resource_uri": "/api/v1/pvinverter/1/"}, ...]}
</code></pre>
  <h2>cURL</h2>
  <p>Use <a target="_blank" href="https://curl.haxx.se/">cURL</a> from the command line.</p>
<pre><code class="language-bash">$ curl -H "Accept: application/json" https://pvfree.azurewebsites.net/api/v1/pvinverter/
  {"meta": {"limit": 20, "next": "/api/v1/pvinverter/?limit=20&amp;offset=20", "offset": 0, "previous": null, "total_count": 1742}, "objects": [{"C0": -2.48104842861e-05, "C1": -9.0149429405099999e-05, "C2": 0.00066889632690700005, "C3": -0.018880466688599998, "Idcmax": 10.0, "Mppt_high": 50.0, "Mppt_low": 20.0, "Paco": 250.0, "Pdco": 259.52205054799998, "Pnt": 0.02, "Pso": 1.7716142241299999, "Vac": 208.0, "Vdcmax": 65.0, "Vdco": 40.242603174599999, "id": 1, "Name": "MICRO-0.25-I-OUTD-US-208", "resource_uri": "/api/v1/pvinverter/1/"}, ...]}
</code></pre>
  <h1>Filters</h1>
  <p>The following fields can be <a target="_blank" 
href="https://django-tastypie.readthedocs.org/en/latest/resources.html?highlight=filtering#basic-filtering">filtered</a> using <a 
target="_blank" href="https://docs.djangoproject.com/en/1.6/ref/models/querysets/#field-lookups" >Django 
ORM</a>. Add the query strings to the API base URL, <a target="_blank" 
href="/api/v1/pvinverter/?format=json"><code>api/pvinverter</code></a>. <i>Note:</i> use encoded 
URI components for the following reserved query string characters: for <b>"&amp;"</b> 
use 
<b>"%26"</b>, for <b>"+"</b> use <b>"%2B"</b>, for <b>"?"</b> 
use <b>"%3F"</b> and for <b>"="</b> use <b>"%3D"</b>.</p>
  <ul>
  <li>field: <code>Name</code>
    <ul>
    <li>filters: <code>iexact</code>, <code>istartswith</code>, <code>icontains</code>, <code>iregex</code>, <code>iendswith</code></li>
    <li>example: <a target="_blank"
href="/api/v1/pvinverter/?format=json&Name__iregex=^Power[-%20]One"><code>?Name__iregex=^Power[- ]One</code></a></li>
    </ul>
  </li>
  <li>field: <code>Vac</code>
    <ul>
    <li>filters: <code>exact</code>, <code>lt</code>, <code>lte</code>, <code>gt</code>, <code>gte</code></li>
    <li>example: <a target="_blank"
href="/api/v1/pvinverter/?format=json&Vaco__gt=200&Vac__lte=300"><code>?Vac__gt=200&amp;Vaco__lte=300</code></a></li>
    </ul>
  </li>
  </ul>
  <h1>Contributions</h1>
  <p>Contribute to <a target="_blank" 
href="https://github.com/SunPower/pvfree">PV Free on GitHub</a>.</p>
</div>

{% endblock %}

{% block footers %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<!-- <script src="{% static 'highlight/highlight.pack.js' %}"></script> -->
<script>hljs.initHighlightingOnLoad();</script>
{% endblock footers %}
